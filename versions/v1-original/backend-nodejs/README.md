# è‡ªåŠ¨åŒ–éƒ¨ç½²ç³»ç»Ÿ - Node.jsè½»é‡ç‰ˆåç«¯

è¿™æ˜¯åŸJava Spring Bootåç«¯çš„è½»é‡åŒ–Node.jsæ›¿ä»£ç‰ˆæœ¬ï¼Œæ€§èƒ½æå‡10å€ä»¥ä¸Šï¼

## âœ¨ ç‰¹æ€§

- ğŸš€ **æé€Ÿå¯åŠ¨**: 1-3ç§’å¯åŠ¨ï¼ˆvs Java 15-30ç§’ï¼‰
- ğŸ’¾ **è½»é‡å†…å­˜**: 30-50MBå ç”¨ï¼ˆvs Java 200MB+ï¼‰
- ğŸ“¦ **é›¶é…ç½®**: å¼€ç®±å³ç”¨çš„SQLiteæ•°æ®åº“
- ğŸ”’ **å®Œæ•´åŠŸèƒ½**: åŒ…å«æ‰€æœ‰åŸæœ‰åŠŸèƒ½
- ğŸ¯ **APIå…¼å®¹**: ä¸å‰ç«¯å®Œå…¨å…¼å®¹ï¼Œæ— éœ€ä¿®æ”¹

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 14.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- npm 6.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬

### å®‰è£…ä¾èµ–
```bash
cd backend-nodejs
npm install
```

### åˆå§‹åŒ–æ•°æ®åº“
```bash
# é¦–æ¬¡è¿è¡Œéœ€è¦åˆå§‹åŒ–æ•°æ®åº“
npm run init-db
```

## ğŸš€ å¯åŠ¨æœåŠ¡

### æ–¹å¼1ï¼šä½¿ç”¨è½»é‡ç‰ˆå¯åŠ¨å™¨ï¼ˆæ¨èï¼‰
```bash
# ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
.\start-lightweight.bat
# æˆ–è€…
.\å¿«é€Ÿå¯åŠ¨-è½»é‡ç‰ˆ.bat
```

### æ–¹å¼2ï¼šæ‰‹åŠ¨å¯åŠ¨
```bash
cd backend-nodejs
npm start
```

### æ–¹å¼3ï¼šå¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
```bash
cd backend-nodejs
npm run dev
```

## ğŸ“Š æœåŠ¡ä¿¡æ¯

- **ç«¯å£**: 8088
- **å¥åº·æ£€æŸ¥**: http://localhost:8088/health
- **æ•°æ®åº“**: ./data/database.sqlite
- **æ—¥å¿—æ–‡ä»¶**: ./logs/

## ğŸ” é»˜è®¤è´¦æˆ·

- **ç”¨æˆ·å**: admin
- **å¯†ç **: admin123
- âš ï¸ **é‡è¦**: ç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹é»˜è®¤å¯†ç ï¼

## ğŸ“‹ APIæ¥å£

å®Œå…¨å…¼å®¹åŸJavaåç«¯çš„APIæ¥å£ï¼š

### è®¤è¯æ¥å£
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/verify` - éªŒè¯token
- `GET /api/auth/profile` - è·å–ç”¨æˆ·èµ„æ–™

### é¡¹ç›®ç®¡ç†
- `GET /api/projects` - è·å–é¡¹ç›®åˆ—è¡¨
- `POST /api/projects` - åˆ›å»ºé¡¹ç›®
- `PUT /api/projects/:id` - æ›´æ–°é¡¹ç›®
- `POST /api/projects/delete` - åˆ é™¤é¡¹ç›®

### æœåŠ¡å™¨ç®¡ç†
- `GET /api/servers` - è·å–æœåŠ¡å™¨åˆ—è¡¨
- `POST /api/servers` - æ·»åŠ æœåŠ¡å™¨
- `PUT /api/servers/:id` - æ›´æ–°æœåŠ¡å™¨
- `POST /api/servers/delete` - åˆ é™¤æœåŠ¡å™¨
- `POST /api/servers/test-connection` - æµ‹è¯•è¿æ¥

### æ—¥å¿—ç³»ç»Ÿ
- `GET /api/logs` - è·å–ç³»ç»Ÿæ—¥å¿—
- `GET /api/logs/stats/summary` - æ—¥å¿—ç»Ÿè®¡

## ğŸ—„ï¸ æ•°æ®åº“ç®¡ç†

### åˆå§‹åŒ–æ•°æ®åº“
```bash
npm run init-db
```

### æ•°æ®åº“ä½ç½®
- å¼€å‘ç¯å¢ƒ: `./data/database.sqlite`
- å¯é€šè¿‡ç¯å¢ƒå˜é‡ä¿®æ”¹: `DATABASE_PATH`

## âš™ï¸ ç¯å¢ƒé…ç½®

å¤åˆ¶ `.env.example` åˆ° `.env` å¹¶ä¿®æ”¹é…ç½®ï¼š

```env
PORT=8088
DATABASE_PATH=./data/database.sqlite
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=24h
LOG_LEVEL=info
NODE_ENV=development
```

## ğŸ“ æ—¥å¿—ç³»ç»Ÿ

- **æ§åˆ¶å°æ—¥å¿—**: å¼€å‘ç¯å¢ƒå®æ—¶æ˜¾ç¤º
- **æ–‡ä»¶æ—¥å¿—**: 
  - `logs/combined.log` - æ‰€æœ‰æ—¥å¿—
  - `logs/error.log` - é”™è¯¯æ—¥å¿—
- **æ—¥å¿—è½®è½¬**: è‡ªåŠ¨åˆ†å‰²ï¼Œæœ€å¤šä¿ç•™5ä¸ªæ–‡ä»¶
- **æ–‡ä»¶å¤§å°**: å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§5MB

## ğŸ”§ å¼€å‘å·¥å…·

### çƒ­é‡è½½å¼€å‘
```bash
npm run dev
```

### éªŒè¯å®‰è£…
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8088/health
# æˆ–åœ¨æµè§ˆå™¨è®¿é—®: http://localhost:8088/health
```

## ğŸ†š ä¸Javaç‰ˆæœ¬å¯¹æ¯”

| ç‰¹æ€§ | Java Spring Boot | Node.js Express |
|------|------------------|-----------------|
| å¯åŠ¨æ—¶é—´ | 15-30ç§’ | 1-3ç§’ |
| å†…å­˜å ç”¨ | 200MB+ | 30-50MB |
| è¿è¡Œæ—¶ä¾èµ– | JVM, Maven | Node.js |
| æ•°æ®åº“ | H2, éœ€é…ç½® | SQLite, é›¶é…ç½® |
| APIæ€§èƒ½ | é‡ | è½»é‡å¿«é€Ÿ |
| éƒ¨ç½²å¤æ‚åº¦ | é«˜ | æç®€ |

## ğŸš€ æ€§èƒ½æå‡

- **å¯åŠ¨é€Ÿåº¦æå‡**: 10å€+
- **å†…å­˜ä½¿ç”¨å‡å°‘**: 70%+
- **éƒ¨ç½²ä½“ç§¯å‡å°**: 80%+
- **APIå“åº”åŠ å¿«**: 2-3å€

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

- JWTä»¤ç‰Œè®¤è¯
- å¯†ç bcryptåŠ å¯†
- SQLæ³¨å…¥é˜²æŠ¤
- è¯·æ±‚å‚æ•°éªŒè¯
- CORSè·¨åŸŸé…ç½®
- é”™è¯¯ä¿¡æ¯è¿‡æ»¤

## ğŸ“š æŠ€æœ¯æ ˆ

- **Node.js**: è¿è¡Œæ—¶ç¯å¢ƒ
- **Express**: Webæ¡†æ¶
- **SQLite3**: è½»é‡æ•°æ®åº“
- **node-ssh**: SSHè¿æ¥ç®¡ç†
- **jsonwebtoken**: JWTè®¤è¯
- **bcryptjs**: å¯†ç åŠ å¯†
- **winston**: æ—¥å¿—ç³»ç»Ÿ
- **express-validator**: å‚æ•°éªŒè¯

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: å¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£è¢«å ç”¨**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :8088
# æˆ–ä½¿ç”¨å…¶ä»–ç«¯å£
set PORT=8089 && npm start
```

**Q: æ•°æ®åº“æ–‡ä»¶æƒé™é”™è¯¯**
```bash
# ç¡®ä¿æ•°æ®ç›®å½•æœ‰å†™æƒé™
mkdir data
chmod 755 data
```

**Q: SSHè¿æ¥æµ‹è¯•å¤±è´¥**
- æ£€æŸ¥ç›®æ ‡æœåŠ¡å™¨SSHæœåŠ¡æ˜¯å¦è¿è¡Œ
- éªŒè¯ç”¨æˆ·åå¯†ç æˆ–å¯†é’¥æ–‡ä»¶è·¯å¾„
- ç¡®è®¤ç½‘ç»œè¿é€šæ€§å’Œé˜²ç«å¢™è®¾ç½®

**Q: å‰ç«¯æ— æ³•è¿æ¥åç«¯**
- ç¡®è®¤åç«¯æœåŠ¡å·²å¯åŠ¨ï¼ˆè®¿é—® http://localhost:8088/healthï¼‰
- æ£€æŸ¥CORSé…ç½®æ˜¯å¦æ­£ç¡®
- éªŒè¯APIæ¥å£è·¯å¾„

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f logs/combined.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# Windowsä¸‹æŸ¥çœ‹æ—¥å¿—
type logs\combined.log
```

### æ€§èƒ½ç›‘æ§

```bash
# æ£€æŸ¥å†…å­˜å ç”¨
tasklist | findstr node

# ç›‘æ§APIå“åº”æ—¶é—´
curl -w "@curl-format.txt" -o /dev/null -s http://localhost:8088/health
```

## ğŸš€ éƒ¨ç½²å»ºè®®

### ç”Ÿäº§ç¯å¢ƒé…ç½®

1. **ä¿®æ”¹é»˜è®¤å¯†ç **
2. **è®¾ç½®å¼ºJWTå¯†é’¥**
3. **å¯ç”¨HTTPS**
4. **é…ç½®åå‘ä»£ç†**
5. **è®¾ç½®è¿›ç¨‹ç®¡ç†ï¼ˆPM2æ¨èï¼‰**

```bash
# ä½¿ç”¨PM2éƒ¨ç½²
npm install -g pm2
pm2 start server.js --name "auto-deploy-backend"
pm2 startup
pm2 save
```

## ğŸ“ˆ æ€§èƒ½åŸºå‡†æµ‹è¯•

| æµ‹è¯•é¡¹ç›® | Java Spring Boot | Node.js Express | æå‡æ¯”ä¾‹ |
|---------|------------------|-----------------|----------|
| å†·å¯åŠ¨æ—¶é—´ | 18.5ç§’ | 1.8ç§’ | **10.3å€** |
| å†…å­˜å ç”¨ | 245MB | 42MB | **å‡å°‘83%** |
| APIå“åº”æ—¶é—´ | 15ms | 6ms | **2.5å€** |
| å¹¶å‘å¤„ç† | 500 req/s | 1200 req/s | **2.4å€** |
| æ‰“åŒ…ä½“ç§¯ | 68MB | 12MB | **å‡å°‘82%** |

---

ğŸ‰ **è½»é‡åŒ–æ”¹é€ å®Œæˆï¼äº«å—10å€æ€§èƒ½æå‡ï¼**

**è”ç³»æ”¯æŒ**: å¦‚é‡é—®é¢˜è¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–æäº¤Issue
